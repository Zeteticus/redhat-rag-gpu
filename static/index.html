<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Hat Documentation RAG - Multi-Format Support</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #ee0000;
            --secondary: #0066cc;
            --dark: #151515;
            --light: #f5f5f5;
            --success: #3e8635;
            --warning: #f0ab00;
            --danger: #c9190b;
        }
        body {
            font-family: "Red Hat Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: var(--light);
            color: var(--dark);
        }
        header {
            background: var(--primary);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo {
            height: 30px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        .card {
            background: white;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .file-upload {
            border: 2px dashed #ccc;
            border-radius: 6px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            background: rgba(0,0,0,0.02);
        }
        .file-upload:hover, .file-upload.drag-over {
            border-color: var(--secondary);
            background: rgba(0,102,204,0.05);
        }
        .upload-icon {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 1rem;
        }
        .btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }
        .btn:hover {
            background: #004c99;
        }
        .btn-secondary {
            background: #f5f5f5;
            color: var(--dark);
            border: 1px solid #ddd;
        }
        .btn-secondary:hover {
            background: #e5e5e5;
        }
        .search-box {
            display: flex;
            margin-bottom: 1rem;
        }
        .search-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
            font-size: 1rem;
        }
        .search-btn {
            border-radius: 0 4px 4px 0;
            padding: 0.75rem 1.5rem;
        }
        .results {
            margin-top: 2rem;
        }
        .result-item {
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }
        .result-title {
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }
        .result-meta {
            font-size: 0.8rem;
            color: #777;
            margin-bottom: 0.5rem;
        }
        .result-content {
            margin-bottom: 0.5rem;
        }
        .highlight {
            background: #fff3cd;
            padding: 0 0.2rem;
        }
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--secondary);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 0.5rem;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden {
            display: none;
        }
        .tag {
            background: #eee;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
            white-space: nowrap;
        }
        .confidence {
            background: var(--success);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            float: right;
        }
        .format-badge {
            display: inline-block;
            margin: 5px;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            background: #f5f5f5;
            border: 1px solid #ddd;
        }
        .format-badge.available {
            background: rgba(62, 134, 53, 0.1);
            border-color: var(--success);
            color: var(--success);
        }
        .format-badge.unavailable {
            background: rgba(201, 25, 11, 0.1);
            border-color: var(--danger);
            color: var(--danger);
            text-decoration: line-through;
        }
        .format-tooltip {
            position: relative;
            display: inline-block;
        }
        .format-tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .format-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .document-list {
            margin-top: 1rem;
        }
        .document-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
        }
        .document-item:hover {
            background: rgba(0,0,0,0.02);
        }
        .document-name {
            font-weight: bold;
        }
        .document-meta {
            font-size: 0.8rem;
            color: #777;
        }
        .document-actions {
            display: flex;
            gap: 0.5rem;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 1.5rem;
        }
        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        .tab.active {
            border-bottom-color: var(--secondary);
            font-weight: bold;
            color: var(--secondary);
        }
    </style>
</head>
<body>
    <header>
        <div>
            <img src="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" alt="Red Hat Logo" class="logo">
            <span style="margin-left: 10px; font-weight: bold;">Documentation RAG</span>
        </div>
        <div>
            <span id="gpu-status" title="GPU Status"><i class="fas fa-microchip"></i> Checking...</span>
        </div>
    </header>

    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="search">Search</div>
            <div class="tab" data-tab="documents">Documents</div>
            <div class="tab" data-tab="settings">Settings</div>
        </div>

        <div id="search-tab" class="tab-content">
            <div class="card">
                <h2>Search Red Hat Documentation</h2>
                <div class="search-box">
                    <input type="text" id="search-input" class="search-input" placeholder="Enter your query...">
                    <button id="search-btn" class="btn search-btn">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
                <div class="filter-options">
                    <label for="category-filter">Category:</label>
                    <select id="category-filter" class="filter-select">
                        <option value="">All Categories</option>
                    </select>
                    
                    <label for="version-filter">RHEL Version:</label>
                    <select id="version-filter" class="filter-select">
                        <option value="">All Versions</option>
                    </select>
                </div>
            </div>

            <div id="loading" class="card hidden">
                <div class="spinner"></div> Searching documents...
            </div>

            <div id="results" class="results hidden">
                <div class="card">
                    <h3>Search Results <span id="result-count">(0)</span></h3>
                    <div id="result-list"></div>
                </div>
            </div>

            <div id="no-results" class="card hidden">
                <h3>No Results Found</h3>
                <p>Try a different search query or upload more documents.</p>
            </div>
        </div>

        <div id="documents-tab" class="tab-content hidden">
            <div class="card">
                <h2>Upload Documents</h2>
                <p>Upload your documents to make them searchable. Supported formats are shown below.</p>
                
                <div id="format-list" class="format-list">
                    <div class="spinner"></div> Loading supported formats...
                </div>
                
                <div class="file-upload" id="drop-area">
                    <i class="fas fa-file-upload upload-icon"></i>
                    <h3>Drag & Drop Files Here</h3>
                    <p>Or click to select files from your device</p>
                    <input type="file" id="file-input" hidden accept=".pdf,.docx,.doc,.txt,.xlsx,.xls,.epub,.html,.htm,.rtf,.odt,.csv">
                    <button class="btn" id="select-file-btn">Select Files</button>
                </div>
                
                <div id="upload-progress" class="hidden">
                    <div class="spinner"></div>
                    <span id="upload-status">Uploading document...</span>
                </div>
                
                <div id="upload-result" class="hidden">
                    <p id="upload-message"></p>
                </div>
            </div>

            <div class="card">
                <h2>Uploaded Documents</h2>
                <button id="refresh-docs-btn" class="btn btn-secondary">
                    <i class="fas fa-sync"></i> Refresh
                </button>
                <button id="reprocess-docs-btn" class="btn btn-secondary">
                    <i class="fas fa-cogs"></i> Reprocess All
                </button>
                
                <div id="document-list" class="document-list">
                    <div class="spinner"></div> Loading documents...
                </div>
            </div>
        </div>

        <div id="settings-tab" class="tab-content hidden">
            <div class="card">
                <h2>System Information</h2>
                <div id="system-info">
                    <div class="spinner"></div> Loading system information...
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab navigation
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show selected tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(`${tabId}-tab`).classList.remove('hidden');
                    
                    // Load data for selected tab
                    if (tabId === 'documents') {
                        loadDocuments();
                        loadSupportedFormats();
                    } else if (tabId === 'settings') {
                        loadSystemInfo();
                    }
                });
            });
            
            // Initialize GPU status
            checkGPUStatus();
            
            // Search functionality
            const searchBtn = document.getElementById('search-btn');
            const searchInput = document.getElementById('search-input');
            
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            
            // Document upload
            const dropArea = document.getElementById('drop-area');
            const fileInput = document.getElementById('file-input');
            const selectFileBtn = document.getElementById('select-file-btn');
            
            selectFileBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    uploadFile(e.target.files[0]);
                }
            });
            
            // Drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, () => {
                    dropArea.classList.add('drag-over');
                }, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, () => {
                    dropArea.classList.remove('drag-over');
                }, false);
            });
            
            dropArea.addEventListener('drop', (e) => {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length) {
                    uploadFile(files[0]);
                }
            }, false);
            
            // Document management
            const refreshDocsBtn = document.getElementById('refresh-docs-btn');
            const reprocessDocsBtn = document.getElementById('reprocess-docs-btn');
            
            refreshDocsBtn.addEventListener('click', loadDocuments);
            reprocessDocsBtn.addEventListener('click', reprocessDocuments);

            // Load initial search filters
            loadSearchFilters();
        });

        // Search functionality
        async function performSearch() {
            const query = document.getElementById('search-input').value.trim();
            if (!query) return;
            
            const categoryFilter = document.getElementById('category-filter').value;
            const versionFilter = document.getElementById('version-filter').value;
            
            const filters = {};
            if (categoryFilter) filters.category = categoryFilter;
            if (versionFilter) filters.version = versionFilter;
            
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            document.getElementById('no-results').classList.add('hidden');
            
            try {
                const response = await fetch('/api/search', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: query,
                        filters: filters,
                        max_results: 20,
                        min_confidence: 0.3
                    })
                });
                
                const data = await response.json();
                
                document.getElementById('loading').classList.add('hidden');
                
                if (data.results && data.results.length > 0) {
                    displayResults(data);
                    document.getElementById('results').classList.remove('hidden');
                } else {
                    document.getElementById('no-results').classList.remove('hidden');
                }
            } catch (error) {
                console.error('Search error:', error);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('no-results').classList.remove('hidden');
            }
        }
        
        function displayResults(data) {
            const resultList = document.getElementById('result-list');
            resultList.innerHTML = '';
            
            document.getElementById('result-count').textContent = `(${data.results.length})`;
            
            data.results.forEach(result => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                
                const confidence = Math.round(result.confidence * 100);
                const confidenceClass = confidence >= 70 ? 'success' : (confidence >= 50 ? 'warning' : 'danger');
                
                resultItem.innerHTML = `
                    <div class="result-title">
                        ${result.title}
                        <span class="confidence" style="background: var(--${confidenceClass})">
                            ${confidence}%
                        </span>
                    </div>
                    <div class="result-meta">
                        Source: <a href="/api/documents/${result.source}" target="_blank">${result.source}</a> | 
                        Page: ${result.page} | 
                        Section: ${result.section} |
                        Category: ${result.category} |
                        Version: ${result.version}
                    </div>
                    <div class="result-content">${highlightQuery(result.content, data.query)}</div>
                    <div class="result-tags">
                        ${result.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `;
                
                resultList.appendChild(resultItem);
            });
        }
        
        function highlightQuery(text, query) {
            // Simple highlighting of query terms in the content
            const terms = query.split(' ').filter(term => term.length > 2);
            let highlightedText = text;
            
            terms.forEach(term => {
                const regex = new RegExp(`(${term})`, 'gi');
                highlightedText = highlightedText.replace(regex, '<span class="highlight">$1</span>');
            });
            
            return highlightedText;
        }
        
        // Document upload
        async function uploadFile(file) {
            const uploadProgress = document.getElementById('upload-progress');
            const uploadResult = document.getElementById('upload-result');
            const uploadMessage = document.getElementById('upload-message');
            const uploadStatus = document.getElementById('upload-status');
            
            uploadProgress.classList.remove('hidden');
            uploadResult.classList.add('hidden');
            uploadStatus.textContent = `Uploading ${file.name}...`;
            
            const formData = new FormData();
            formData.append('file', file);
            
            try {
                const response = await fetch('/api/documents/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                uploadProgress.classList.add('hidden');
                uploadResult.classList.remove('hidden');
                
                if (response.ok) {
                    uploadMessage.innerHTML = `<span style="color: var(--success);">
                        <i class="fas fa-check-circle"></i> ${result.message || 'Document uploaded successfully!'}
                    </span>`;
                    
                    // Refresh document list
                    loadDocuments();
                } else {
                    uploadMessage.innerHTML = `<span style="color: var(--danger);">
                        <i class="fas fa-exclamation-circle"></i> ${result.detail || 'Upload failed.'}
                    </span>`;
                }
            } catch (error) {
                console.error('Upload error:', error);
                uploadProgress.classList.add('hidden');
                uploadResult.classList.remove('hidden');
                uploadMessage.innerHTML = `<span style="color: var(--danger);">
                    <i class="fas fa-exclamation-circle"></i> Upload failed: ${error.message}
                </span>`;
            }
        }
        
        // Document management
        async function loadDocuments() {
            const documentList = document.getElementById('document-list');
            documentList.innerHTML = '<div class="spinner"></div> Loading documents...';
            
            try {
                const response = await fetch('/api/documents');
                const data = await response.json();
                
                if (data.documents && data.documents.length > 0) {
                    documentList.innerHTML = '';
                    
                    data.documents.forEach(doc => {
                        const docItem = document.createElement('div');
                        docItem.className = 'document-item';
                        
                        const docSize = formatFileSize(doc.size);
                        const processedStatus = doc.processed ? 
                            '<span style="color: var(--success);"><i class="fas fa-check-circle"></i> Processed</span>' : 
                            '<span style="color: var(--warning);"><i class="fas fa-clock"></i> Pending</span>';
                        
                        docItem.innerHTML = `
                            <div class="document-info">
                                <div class="document-name">${doc.filename}</div>
                                <div class="document-meta">
                                    ${docSize} | ${doc.file_type} | ${processedStatus}
                                </div>
                            </div>
                            <div class="document-actions">
                                <a href="/api/documents/${doc.filename}" target="_blank" class="btn btn-secondary">
                                    <i class="fas fa-eye"></i> View
                                </a>
                            </div>
                        `;
                        
                        documentList.appendChild(docItem);
                    });
                } else {
                    documentList.innerHTML = '<p>No documents found. Upload documents to get started.</p>';
                }
            } catch (error) {
                console.error('Load documents error:', error);
                documentList.innerHTML = '<p>Error loading documents. Please try again.</p>';
            }
        }
        
        async function reprocessDocuments() {
            const reprocessBtn = document.getElementById('reprocess-docs-btn');
            reprocessBtn.disabled = true;
            reprocessBtn.innerHTML = '<div class="spinner"></div> Reprocessing...';
            
            try {
                const response = await fetch('/api/documents/reprocess', {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                alert(result.message || 'Document reprocessing initiated.');
                
                // Reload documents after a delay
                setTimeout(loadDocuments, 2000);
            } catch (error) {
                console.error('Reprocess error:', error);
                alert('Error reprocessing documents: ' + error.message);
            } finally {
                reprocessBtn.disabled = false;
                reprocessBtn.innerHTML = '<i class="fas fa-cogs"></i> Reprocess All';
            }
        }
        
        // Format management
        async function loadSupportedFormats() {
            const formatList = document.getElementById('format-list');
            formatList.innerHTML = '<div class="spinner"></div> Loading supported formats...';
            
            try {
                const response = await fetch('/api/formats');
                const data = await response.json();
                
                if (data.supported_formats) {
                    formatList.innerHTML = '';
                    
                    Object.entries(data.supported_formats).forEach(([format, info]) => {
                        const formatBadge = document.createElement('div');
                        formatBadge.className = `format-badge ${info.available ? 'available' : 'unavailable'}`;
                        
                        let badgeContent = `${format} - ${info.description}`;
                        
                        // If format is unavailable and has a reason, add tooltip
                        if (!info.available && info.reason) {
                            formatBadge.classList.add('format-tooltip');
                            badgeContent += `<span class="tooltip-text">${info.reason}</span>`;
                        }
                        
                        formatBadge.innerHTML = badgeContent;
                        formatList.appendChild(formatBadge);
                    });
                    
                    // Update file input accept attribute
                    const availableFormats = Object.entries(data.supported_formats)
                        .filter(([_, info]) => info.available)
                        .map(([format, _]) => format)
                        .join(',');
                    
                    document.getElementById('file-input').setAttribute('accept', availableFormats);
                } else {
                    formatList.innerHTML = '<p>Error loading format information.</p>';
                }
            } catch (error) {
                console.error('Load formats error:', error);
                formatList.innerHTML = '<p>Error loading supported formats.</p>';
            }
        }
        
        // System information
        async function loadSystemInfo() {
            const systemInfo = document.getElementById('system-info');
            systemInfo.innerHTML = '<div class="spinner"></div> Loading system information...';
            
            try {
                const statsResponse = await fetch('/api/stats');
                const statsData = await statsResponse.json();
                
                const healthResponse = await fetch('/health');
                const healthData = await healthResponse.json();
                
                let infoHTML = `
                    <div>
                        <h3>Document Statistics</h3>
                        <p>Total Documents: ${statsData.total_documents}</p>
                        <p>Total Chunks: ${statsData.total_chunks}</p>
                        <p>Total Queries: ${statsData.total_queries}</p>
                        <p>Average Response Time: ${statsData.avg_response_time_ms}ms</p>
                        <p>Last Updated: ${new Date(statsData.last_updated).toLocaleString()}</p>
                        
                        <h3>System Status</h3>
                        <p>Status: ${healthData.status}</p>
                        <p>GPU: ${statsData.gpu_enabled ? statsData.gpu_info : 'Not available'}</p>
                        <p>Version: ${healthData.version}</p>
                        <p>Timestamp: ${new Date(healthData.timestamp).toLocaleString()}</p>
                        
                        <h3>Storage Information</h3>
                        <div>
                            <button id="fix-permissions-btn" class="btn btn-secondary">
                                <i class="fas fa-wrench"></i> Fix Permissions
                            </button>
                        </div>
                    </div>
                `;
                
                systemInfo.innerHTML = infoHTML;
                
                // Add event listener for fix permissions button
                document.getElementById('fix-permissions-btn').addEventListener('click', fixPermissions);
            } catch (error) {
                console.error('Load system info error:', error);
                systemInfo.innerHTML = '<p>Error loading system information.</p>';
            }
        }
        
        async function fixPermissions() {
            const fixPermissionsBtn = document.getElementById('fix-permissions-btn');
            fixPermissionsBtn.disabled = true;
            fixPermissionsBtn.innerHTML = '<div class="spinner"></div> Fixing...';
            
            try {
                const response = await fetch('/fix-permissions', {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                alert(result.message || 'Permissions fixed successfully.');
            } catch (error) {
                console.error('Fix permissions error:', error);
                alert('Error fixing permissions: ' + error.message);
            } finally {
                fixPermissionsBtn.disabled = false;
                fixPermissionsBtn.innerHTML = '<i class="fas fa-wrench"></i> Fix Permissions';
            }
        }
        
        // GPU status
        async function checkGPUStatus() {
            const gpuStatus = document.getElementById('gpu-status');
            
            try {
                const response = await fetch('/gpu-info');
                const data = await response.json();
                
                if (data.gpu_available) {
                    gpuStatus.innerHTML = `
                        <i class="fas fa-microchip" style="color: #3e8635;"></i> 
                        GPU Active: ${data.device_name}
                    `;
                    gpuStatus.title = `CUDA: ${data.cuda_version} | Memory: ${data.memory.total.toFixed(1)}GB`;
                } else {
                    gpuStatus.innerHTML = `
                        <i class="fas fa-microchip" style="color: #c9190b;"></i>
                        CPU Mode
                    `;
                    gpuStatus.title = "GPU not available, using CPU for processing";
                }
            } catch (error) {
                console.error('GPU status check error:', error);
                gpuStatus.innerHTML = `
                    <i class="fas fa-microchip" style="color: #f0ab00;"></i>
                    Status Unknown
                `;
                gpuStatus.title = "Could not determine GPU status";
            }
        }
        
        // Search filters
        async function loadSearchFilters() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                const categoryFilter = document.getElementById('category-filter');
                const versionFilter = document.getElementById('version-filter');
                
                // Clear existing options
                categoryFilter.innerHTML = '<option value="">All Categories</option>';
                versionFilter.innerHTML = '<option value="">All Versions</option>';
                
                // Add categories
                if (data.categories) {
                    Object.keys(data.categories).sort().forEach(category => {
                        if (category !== 'unknown') {
                            const option = document.createElement('option');
                            option.value = category;
                            option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                            categoryFilter.appendChild(option);
                        }
                    });
                }
                
                // Add versions
                if (data.versions) {
                    Object.keys(data.versions).sort().forEach(version => {
                        if (version !== 'unknown') {
                            const option = document.createElement('option');
                            option.value = version;
                            option.textContent = version.toUpperCase();
                            versionFilter.appendChild(option);
                        }
                    });
                }
            } catch (error) {
                console.error('Load filters error:', error);
            }
        }
        
        // Helper functions
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
            return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' GB';
        }
    </script>
</body>
</html>
